<!DOCTYPE html>
<html lang="en">
    <!-- title -->
<!-- keywords -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="John Doe">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="John Doe">
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    <meta name="description" content="">
    <meta name="description" content="汇总论文SAND: A Static Analysis Approach for Detecting SQL Antipatterns Lyu, Yingjun, et al. “Sand: A static analysis approach for detecting sql antipatterns.” Proceedings of the 30th ACM SIGSOFT Internat">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2024/10/28/%E6%B1%87%E6%80%BB/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="汇总论文SAND: A Static Analysis Approach for Detecting SQL Antipatterns Lyu, Yingjun, et al. “Sand: A static analysis approach for detecting sql antipatterns.” Proceedings of the 30th ACM SIGSOFT Internat">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/static/W6Z5bXa5aoAOvLxQUS6cbD1znsc.png">
<meta property="og:image" content="http://example.com/static/G6mIb2rfXoID8UxAxHiciyj2nCa.png">
<meta property="og:image" content="http://example.com/static/Ea7dbx5uJo2kkRxa7C1ctsdQn5e.png">
<meta property="og:image" content="http://example.com/static/X0cobZM0MohGAPxrwyzcDJSSn5f.png">
<meta property="og:image" content="http://example.com/static/S6vKb1aDuopQioxH5vncBMWjnfd.png">
<meta property="article:published_time" content="2024-10-28T09:48:21.193Z">
<meta property="article:modified_time" content="2024-10-28T09:48:21.193Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/static/W6Z5bXa5aoAOvLxQUS6cbD1znsc.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/favicon.ico">
    <title>fi3ework&#39;s Studio</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .footer-fixed-btn,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(
            -45deg,
            #444 0,
            #444 80px,
            #333 80px,
            #333 160px
        );
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link id="stylesheet-fancybox" rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link id="stylesheet-base" rel="preload" href="/css/style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link id="stylesheet-mobile" rel="preload" href="/css/mobile.css" as="style" onload="this.onload=null;this.rel='stylesheet';this.media='screen and (max-width: 960px)'">
    <link id="stylesheet-theme-dark" rel="preload" href="/css/dark.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    <!-- 百度统计  -->
    <!-- 谷歌统计  -->
    <!-- Google tag (gtag.js) -->
<meta name="generator" content="Hexo 7.3.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
        <body class="post-body">
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        <div class="header-sidebar-menu">
            <div style="padding-left: 1px;">&#xe775;</div>
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href="/">fi3ework's Studio.</a>
        </span>
    </div>
    <!-- toggle banner -->
    <div class="banner">
        <div class="blog-title header-element">
            <a href="/">fi3ework&#39;s Studio.</a>
        </div>
        <div class="post-title header-element">
            <a href="#" class="post-name"></a>
        </div>
    </div>
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- donate button -->

    <!-- back to top button -->
    <div class="footer-fixed-btn footer-fixed-btn--hidden back-top">
        <div>&#xe639;</div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="    height:50vh;
">
    <!-- 主页  -->
    <!-- 404页  -->
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
                [Untitled Post]
            <!-- 404 -->
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            <!-- 404 -->
        </p>
        <!-- 文章页 meta -->
            <div class="post-intros">
                <!-- 文章页标签  -->
                    <div class="post-intro-tags" >
</div>

                <!-- 文章字数统计 -->
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2024/10/28</span>
                    <!-- busuanzi -->
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" alt="loading">
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <h1 id="汇总"><a href="#汇总" class="headerlink" title="汇总"></a>汇总</h1><h2 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h2><h3 id="SAND-A-Static-Analysis-Approach-for-Detecting-SQL-Antipatterns"><a href="#SAND-A-Static-Analysis-Approach-for-Detecting-SQL-Antipatterns" class="headerlink" title="SAND: A Static Analysis Approach for Detecting SQL Antipatterns"></a>SAND: A Static Analysis Approach for Detecting SQL Antipatterns</h3><blockquote>
<p>Lyu, Yingjun, et al. “Sand: A static analysis approach for detecting sql antipatterns.” <em>Proceedings of the 30th ACM SIGSOFT International Symposium on Software Testing and Analysis</em>. 2021.</p>
</blockquote>
<h4 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h4><p>本地数据库支撑着许多移动应用程序的重要功能，例如面对连接不良时的响应能力。然而，如果不正确使用此类数据库，可能会导致资源消耗过高，甚至出现安全漏洞。我们提出了 SAND，这是一种可扩展的静态分析方法，用于检查移动应用程序中本地数据库的滥用情况，也称为 SQL 反模式。 SAND 为应用程序&#x2F;数据库交互的常见形式提供了新颖的抽象，这使得 SAND 检查的反模式能够简洁而精确地规范。为了验证 SAND 的功效，我们对 1,000 个 Android 应用程序进行了实验。我们表明，支持 SAND 的抽象允许对文献（12-74 LOC）中的所有已知反模式进行简明规范，并且反模式可以准确建模（99.4-100% 精度）。至于性能，SAND 在移动应用程序上完成扫描平均需要 41 秒。</p>
<h4 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h4><p>本地数据库支撑着许多移动应用程序的重要功能，例如面对连接不良时的响应能力。然而，如果不正确使用此类数据库，可能会导致资源消耗过高，甚至出现安全漏洞。</p>
<h4 id="SQL-注入不良模式的关系"><a href="#SQL-注入不良模式的关系" class="headerlink" title="SQL 注入不良模式的关系"></a>SQL 注入不良模式的关系</h4><h4 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h4><h5 id="基本定义"><a href="#基本定义" class="headerlink" title="基本定义"></a>基本定义</h5><ol>
<li>基本单位：silica</li>
</ol>
<blockquote>
<p>它由 (p,r) 组成，其中 p 是数据库交互点，r 是 p 处可能发出的 SQL 语句的字符串模型</p>
</blockquote>
<ol>
<li>S 为被测应用程序（AUT）中所有硅的集合</li>
</ol>
<blockquote>
<ol>
<li>{s1,s2,s3,……}</li>
</ol>
</blockquote>
<ol>
<li>R 为所有模型的集合</li>
</ol>
<blockquote>
<ol>
<li>{r1,r2,r3,……}</li>
</ol>
</blockquote>
<ol>
<li>D 为所有数据库交互点的集合</li>
</ol>
<blockquote>
<ol>
<li>{p1,p2,p3,……}</li>
</ol>
</blockquote>
<ol>
<li>P 为所有程序语句的集合。</li>
</ol>
<blockquote>
<ol>
<li>{stm1,stm2,stm3,……}</li>
</ol>
</blockquote>
<h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><p><img src="/static/W6Z5bXa5aoAOvLxQUS6cbD1znsc.png"></p>
<h5 id="抽象设计"><a href="#抽象设计" class="headerlink" title="抽象设计"></a>抽象设计</h5><p>参考：Ding Li, Yingjun Lyu, MianWan, and William G. J. Halfond. 2015. String Analysis for Java and Android Applications. In Proceedings ofthe 2015 10th Joint Meeting on Foundations ofSoftware Engineering (Bergamo, Italy)(ESEC&#x2F;FSE 2015). ACM, New York, NY, USA, 661–672. 9</p>
<ol>
<li>getSQLModel : 𝑝 ∈ 𝐷 ↦→ 𝑟 ∈ 𝑅.</li>
</ol>
<blockquote>
<ol>
<li>数据库交互点调用不同类型的数据库 API，并且每种类型都有构建 SQL 语句的特定语义。</li>
<li>其次，构造 SQL 语句的过程非常复杂。事实上，前三个最常用的数据库 API 中有两个发出基于原始字符串的 SQL 语句，其中一半是通过复杂的字符串操作动态构造的。<ol>
<li>SAND 基于<u>字符串分析的通用框架 Violist 的中间表示</u>进行扩展。</li>
<li>在清单 1 的第 13 行，𝜓(𝑟) &#x3D; {INSERT INTO reg (id) VALUES (𝑋7)}。为了生成 𝜓(𝑟)，SAND 解析由 r 表示的表达式树。</li>
<li>扩展点：SAND 结合了各种数据库 API 的语义并相应地构造了模型 r</li>
<li>例如 line4，SAND 回结合语义构造为</li>
</ol>
</li>
<li></li>
<li><ul>
<li>“SELECT” (+ “id, name, grade” +<br>(“FROM” (+ “students” (+ “WHERE” (+ “name &#x3D; ”𝑋3)))))</li>
</ul>
</li>
</ol>
</blockquote>
<ol>
<li>getDefSet : 𝑠 ∈ 𝑆 ↦→ {⟨f, placeholder⟩ | 𝑓 ∈ 𝑃, placeholder ∈ Σ∗}</li>
</ol>
<blockquote>
<ol>
<li>例如，给定清单 1 第 13 行的 silica  𝑠，getDefSet(𝑠) &#x3D; {⟨𝑙𝑖𝑛𝑒 7, 𝑋7⟩}，表示在第 7 行的程序点定义了标记为 𝑋7 的外部输入。</li>
</ol>
</blockquote>
<ol>
<li>getUseSet : 𝑠 ∈ 𝑆 ↦→ {⟨𝑢, 𝑐𝑜𝑙𝑢𝑚𝑛⟩ | 𝑢 ∈ 𝑃, 𝑐𝑜𝑙𝑢𝑚𝑛 ∈ Σ∗}</li>
</ol>
<blockquote>
<ol>
<li>例如，在 清单 1 中，给定第 4 行的 silica 𝑠，返回元组之一是 ⟨𝑙𝑖𝑛𝑒 8, 𝑖𝑑⟩。元组意味着第 8 行使用了 id 列。</li>
<li>挑战<ol>
<li>查询的输出数据存储在一个复杂的对象中，即游标。识别数据的使用不仅需要跟踪该游标对象，还需要跟踪从中检索到的任何列数据</li>
<li>解决： 污点分析</li>
<li>游标 API 提供了灵活的方式（即通过列索引或列名称）从游标对象检索所需的列，这使得 SAND 难以将数据的使用与列静态关联。</li>
<li>解决：column identification analysis</li>
<li>使用列名作为列检索 API 的参数：字符串分析</li>
<li>使用列索引作为列检索 API 的参数：识别其值后，SAND 将索引映射到名称</li>
<li>如果查询显式选择列，则可以通过分析查询本身来完成映射。更具体地说，SAND 解析 SQL 语句，按顺序提取选定的列，并将索引值与相应的列进行匹配。例如，给定查询“SELECT id, name,grade FROM Students”和索引零，索引零映射到列 𝑖𝑑。</li>
<li>如果查询隐式选择列，则映射不仅需要分析查询，还需要分析表结构。为此，SAND 首先解析 SQL 语句并识别所选表。然后利用 find 函数查找对应的建表语句。接下来，SAND 通过解析建表语句来获取列顺序。最后，SAND 将索引值与列进行匹配。使用说明性示例，如果查询是“SELECT * FROM Students”并且表创建语句是“CREATE TABLE Students (id INT, name TEXT, Grade TEXT)”，则列索引零映射到列 𝑖𝑑。 SAND 目前假设表创建是在附带的应用程序代码中完成的。</li>
<li>如果应用程序附带预先创建的数据库表，SAND 还不会分析这些表，而是会使用列名的占位符。当选择列但其名称未知时，SAND 会使用占位符 𝜔 作为列名称来注释受污染的变量。引入占位符 𝜔 是有必要的，原因有两个。首先，列检索 API 的参数可以从外部源导出。其次，建表语句不在 app 代码中，但识别列名需要分析表。在这两种情况下，列标识分析无法从代码静态确定列名称。</li>
</ol>
</li>
</ol>
</blockquote>
<ol>
<li>getReachableSet : 𝑝 ∈ 𝑃 ↦→ {𝑔 | 𝑔 ∈ 𝑃}</li>
</ol>
<blockquote>
<ol>
<li>通过其进行 SQL 语句之间的可达性关系。给定一个程序点 𝑝，该函数返回一组程序点，{𝑔 | 𝑔 ε 𝑃}。这是检测四种 SQL 反模式（即 Not-Merging-Projection-Predicates-2、Not-Merging-Selection-Predicates-2）所需要的。我们仅关注 SQL 注入，因此不关注这部分。</li>
</ol>
</blockquote>
<ol>
<li>getLoopSet : 𝑝 ∈ 𝑃 ↦→ {𝑙 | 𝑙 ∈ 𝑃}</li>
</ol>
<blockquote>
<ol>
<li>在清单 1 中，包含第 13 行程序点的循环的标头分别位于第 5 行和第 11 行。该函数满足表达三种 SQL 反模式（即 Unbatched-Writes-2、Loop-to-Join-4 和 Unbounded-Query-3）检测规则的需求。</li>
</ol>
</blockquote>
<ol>
<li>getControlDependenceSet : 𝑝 ∈ 𝑃 ↦→ {⟨𝑐, 𝑖⟩ | 𝑐 ∈ 𝑃, 𝑖 ∈ Z}.</li>
</ol>
<blockquote>
<p>给定一个程序点 𝑝，该函数返回一组元组，每个元组的形式为⟨𝑐，𝑖⟩。程序点 𝑐 和整数 𝑖 一起表示 if&#x2F;switch 语句 𝑝 的哪个分支是传递控制依赖的。例如，在清单 1 中，第 13 行是传递控制，依赖于第 5、8 和 11 行的三个条件语句（当它们评估为 true 时）。因此，返回集为 {⟨𝑙𝑖𝑛𝑒 5, 1⟩, ⟨𝑙𝑖𝑛𝑒 8, 1⟩, ⟨𝑙𝑖𝑛𝑒 11, 1⟩}⟩，其中 true 分支由值 1 表示</p>
</blockquote>
<ol>
<li>getTransactionSet : 𝑝 ∈ 𝐷 ↦→ {𝑡 | 𝑡 ∈ 𝑃}</li>
</ol>
<blockquote>
<ol>
<li>给定一个数据库交互点 𝑝 ，并返回一组程序点{𝑡 | 𝑡 ∈ 𝑃},包含给定程序点的事务在其中启动。在清单 1 中，第 13 行的数据库交互点包含在第 10 行启动的事务。事务控制的灵活语义给 getTransactionSet 函数的实现带来了巨大的挑战。为了准确有效地分析事务，SAND 使用专门用于建模嵌套事务控制的静态分析技术[39]。给定发出 SQL 语句的程序点，分析会在 CFG 中向后传播该程序点，并使用计数器沿着通向给定程序点的路径跟踪对事务打开和关闭操作的调用。使用计数器值，分析能够判断交易在某个程序点是打开还是关闭。</li>
</ol>
</blockquote>
<h5 id="过程间分析"><a href="#过程间分析" class="headerlink" title="过程间分析"></a>过程间分析</h5><p>在执行过程间分析时，SAND 将每个活动生命周期方法视为 AUT 的入口点。在每个活动生命周期方法中，SAND 使用 AUT 的克隆调用图 (CCG) [45] 来执行过程间分析。</p>
<p>虽然 CCG 通常对于小程序来说也相当大，但 SAND 的设计允许它修剪 AUT 的调用图，以便仅保留包含二氧化硅的方法的传递调用者及其传递被调用者。</p>
<p>在我们对 1,000 个基准测试（Google Play 应用商店中排名靠前的应用程序）的评估中，我们观察到，与许多其他问题域不同，Android 应用程序中的本地数据库访问通常会产生相对稀疏（尽管是过程间）的切片；这使得我们的分析能够删除 96% 的应用程序代码（在我们的 1,000 个主题应用程序中），从而使控制流和数据流分析更加高效。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>SAND 基于 Soot 分析框架[30]。 Soot 帮助将应用程序的二进制文件转换为字节码的中间表示形式，称为 Jimple。 SAND 进行的所有分析均基于 Jimple 字节码。</p>
<p>开源地址： <u><a target="_blank" rel="noopener" href="https://github.com/USC-SQL/SAND">https://github.com/USC-SQL/SAND</a></u> <u><a target="_blank" rel="noopener" href="https://github.com/USC-SQL/SAND">https://github.com/USC-SQL/SAND</a></u></p>
<h4 id="评估"><a href="#评估" class="headerlink" title="评估"></a>评估</h4><h5 id="评估指标"><a href="#评估指标" class="headerlink" title="评估指标"></a>评估指标</h5><ol>
<li>SAND 探测器的精度是多少？</li>
<li>SAND 探测器的速度有多快？</li>
<li>检测脚本的复杂性是多少？</li>
</ol>
<h5 id="样本"><a href="#样本" class="headerlink" title="样本"></a>样本</h5><p>1,000 个不同的 Android 应用程序。为了确保多样性，我们选择了以下应用程序：</p>
<ol>
<li>下载频繁；</li>
<li>针对不同的功能目的进行设计（以便覆盖不同种类的本地数据库用途）；</li>
<li>代码量不同。</li>
</ol>
<p>对于商店定义的 34 个类别中的每一个，我们都下载了该类别中排名靠前的应用程序，并确认这些应用程序可以与 Soot 配合使用。</p>
<p>计算了它们拥有的代码量。结果显示，这些应用程序中有 16% 的字节码少于 10K，其中 48% 的字节码数量在 10K 到 100K 之间，36% 的字节码超过 100K。这些数字表明这些应用程序的代码大小各不相同。</p>
<h5 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h5><ol>
<li>精准度</li>
</ol>
<p><img src="/static/G6mIb2rfXoID8UxAxHiciyj2nCa.png"></p>
<ol>
<li>计算了在主题应用程序上运行的 11 个检测器的执行时间。该执行时间包括从转换应用程序字节码到进行各种分析的整个检测过程。为了验证缓存机制在提高 SAND 检测器执行时间方面的贡献，我们在同一组应用程序上运行检测器，同时禁用缓存机制。实验结果表明，在一个应用程序上运行所有 SAND 检测器的平均执行时间和中值执行时间分别为 41 秒和 21 秒。对于 92% 的应用程序，所有检测分析都在 60 秒内完成。当分解总执行时间时，我们发现总时间的 42%（平均 18 秒）被 Soot 转换字节码消耗，总时间的 14%（平均 6 秒）被 Violist 字符串分析执行消耗。如果禁用缓存机制，运行所有检测器的平均执行时间将达到 289 秒，比启用缓存的运行检测器的执行时间长七倍。中位执行时间相似（22 秒）。总而言之，这些数字表明 SAND 探测器在分析现代市场移动应用程序方面非常有效。</li>
<li>对于每个 SAND 检测器，我们计算了指定检测规则所需的谓词数量、脚本中 Java 代码 (LOC) 的行数以及脚本中代码的圈复杂度 [42 ]。结果总结在表 4 中。谓词数量范围为 3 到 7。SAND 脚本的 LOC 范围为 12 到 74。LOC 的平均值为 32，中位数为 25。在 11 个脚本中，10&#x2F;其中 11 个的 LOC 少于或接近 50。无界查询的检测器需要 74 个 LOC，因为该技术提出的检测规则检查查询本身的几个属性，以确定查询是无界的 [61]。处理查询字符串需要大约 40 行代码。除了紧凑之外，代码复杂度也很低。对圈复杂度的研究建议使用不同的值（10、15 和 20）作为可接受和复杂之间的阈值 [42,60,65]。如表 4 所示，6&#x2F;11 的脚本复杂度值在 10 以内； 10&#x2F;11 的脚本的复杂度值在 15 以内；并且所有脚本的复杂度值都在 20 以内。这些数字表明大多数脚本的复杂度值都在或接近阈值。虽然有一个脚本超过了 10 和 15 的阈值，但我们发现复杂度很高是由于检测 Unbounded-Query 时查询字符串的处理代码所致。如果我们在计算圈复杂度时不考虑这部分代码，则无界查询检测器的复杂度值为 9。基于这些结果，可以使用 SAND 的抽象来紧凑地表达检测规则。</li>
</ol>
<p><img src="/static/Ea7dbx5uJo2kkRxa7C1ctsdQn5e.png"></p>
<h3 id="SQLPsdem-A-Proxy-Based-Mechanism-Towards-Detecting-Locating-and-Preventing-Second-Order-SQL-Injections"><a href="#SQLPsdem-A-Proxy-Based-Mechanism-Towards-Detecting-Locating-and-Preventing-Second-Order-SQL-Injections" class="headerlink" title="SQLPsdem: A Proxy-Based Mechanism Towards  Detecting, Locating and Preventing  Second-Order SQL Injections"></a>SQLPsdem: A Proxy-Based Mechanism Towards  Detecting, Locating and Preventing  Second-Order SQL Injections</h3><blockquote>
<p>Zhang, Bing, et al. “SQLPsdem: A Proxy-based Mechanism towards Detecting, Locating and Preventing Second-Order SQL Injections.” IEEE Transactions on Software Engineering (2024).</p>
</blockquote>
<h4 id="研究动机"><a href="#研究动机" class="headerlink" title="研究动机"></a>研究动机</h4><p>该研究的主要动机是解决当前方法在检测和防止二阶 SQL 注入（SQLi）漏洞方面的局限性。二阶 SQL 注入由于其隐藏性强和触发阶段复杂，导致现有检测方法存在较高的漏报和误报率。这些攻击对 Web 应用程序的安全性构成了严重威胁，亟需更加有效的解决方案。</p>
<h4 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h4><p>论文提出了 SQLPsdem，一种基于代理的机制，结合静态分析和动态执行，用于检测、定位和防止一阶和二阶 SQL 注入攻击。主要贡献包括：</p>
<ul>
<li>提出了一种全面的静态分析方法，能够识别所有可能的 SQL 注入点（SIPs）并重构 SQL 语句，以生成攻击样本。</li>
<li>设计了一种动态代理执行机制，可以捕获 Web 应用程序与数据库之间传输的 SQL 查询，并基于攻击模式检测 SQL 注入。</li>
<li>创新性地结合多个流行的攻击引擎生成广泛的 SQL 注入攻击，显著减少了漏报和误报。</li>
<li>识别出了 13 个新的二阶 SQL 注入漏洞，提升了所选开源 Web 应用的安全性。</li>
</ul>
<h4 id="设计-1"><a href="#设计-1" class="headerlink" title="设计"></a>设计</h4><p>SQLPsdem 的设计分为两个主要模块：</p>
<ul>
<li><strong>静态分析模块</strong>：该模块负责在 Web 应用程序的源代码中识别并定位 SQL 语句，分类这些语句的类型，并通过分析与 SQL 语句交互的变量来识别潜在的 SQL 注入点。</li>
<li><strong>动态执行模块</strong>：该模块利用代理拦截并分析 Web 应用程序与数据库之间传输的 SQL 查询，使用预定义的攻击模式来检测 SQL 注入攻击，并通过字符转义和截断等防御机制来防止恶意 SQL 查询的执行。</li>
</ul>
<p><img src="/static/X0cobZM0MohGAPxrwyzcDJSSn5f.png"></p>
<h5 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h5><ol>
<li>基于代理的架构：</li>
</ol>
<p>SQLPsdem 的核心是一个基于代理的静态分析和动态执行机制。该架构利用代理在 Web 应用程序和后台数据库之间拦截和分析 SQL 查询或命令，在它们执行之前进行检查，确保能够全面识别一阶和二阶 SQL 注入漏洞。</p>
<ol>
<li>静态分析：</li>
</ol>
<p>全面的静态分析：SQLPsdem 首先对 Web 应用的源码进行静态分析，定位 SQL 语句，并识别所有可能被利用的数据源和注入点（SIPs），如 Post 请求、Session、Cookie、文件名等。通过这种方式确保不会遗漏潜在的注入漏洞。</p>
<p>SQL 标记：系统对 SQL 语句中的标记进行标注，区分用户输入、外部数据源和代码中的 SQL 标记，以保证分析的准确性。</p>
<ol>
<li>动态执行：</li>
</ol>
<p>SQL 语句重构：在识别出注入点之后，SQLPsdem 通过添加头标签和内部标签重构 SQL 语句，这有助于跟踪和区分用户输入与代码中的 SQL 标记，从而更加有效地检测恶意载荷。</p>
<p>基于代理的动态分析：通过使用代理服务器，SQLPsdem 动态拦截和分析 Web 应用与数据库之间的 SQL 查询，确保这些查询在执行之前就能被检测到是否包含恶意注入。</p>
<ol>
<li>测试用例生成：</li>
</ol>
<p>使用攻击引擎生成恶意载荷：SQLPsdem 结合了多种流行的攻击引擎（如 SQLmap、JSQLi 等）来生成 SQL 注入测试用例，以确保覆盖最新的注入攻击技术。</p>
<p>多种攻击模式：系统能够识别七种常见的 SQL 注入攻击模式，包括恒等式攻击、联合查询、追加查询等。</p>
<ol>
<li>降低误报率和漏报率：</li>
</ol>
<p>通过基于规则的匹配机制，SQLPsdem 将拦截到的 SQL 查询与已知的攻击模式进行比较，从而减少误报和漏报的可能性。此外，SQL 语句中的标签可以确保 SQLPsdem 区分代码中和用户输入中的 SQL 标记，进一步提高检测的准确性。</p>
<ol>
<li>防御机制：</li>
</ol>
<p>SQLPsdem 不仅能检测到注入漏洞，还能通过转义和截断恶意载荷，阻止它们影响数据库。这意味着在检测到攻击时，系统能够在数据进入数据库之前就将其中和。</p>
<h5 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h5><ol>
<li>SQL 注入点的识别：</li>
</ol>
<p>SQLPsdem 通过静态分析定位所有潜在的 SQL 注入点（SIPs），包括 Session、Cookie 和文件名等数据源，确保了对潜在注入点的全面覆盖，这弥补了很多现有检测系统的不足。</p>
<p>模块化和可扩展的架构：</p>
<ol>
<li>SQLPsdem 设计为模块化结构</li>
</ol>
<p>各个模块（如静态分析、动态执行、攻击生成等）可以独立替换或更新，允许在出现新的攻击模式时快速适应和升级。</p>
<ol>
<li>SQL 查询的动态拦截：</li>
</ol>
<p>系统使用代理服务器（如 Mysql-Proxy）动态拦截 Web 应用在运行时与数据库之间的 SQL 查询，并在这些查询执行之前对其进行解析和分析。</p>
<p>基于规则的检测系统：</p>
<ol>
<li>SQLPsdem 采用基于规则的匹配系统</li>
</ol>
<p>通过规则对 SQL 查询进行模式匹配，检测可能的 SQL 注入攻击。匹配的规则基于 SQL 查询的结构以及恶意注入技术的已知模式，确保系统能够精确检测攻击。</p>
<ol>
<li>字符转义和截断：</li>
</ol>
<p>作为预防手段，SQLPsdem 会在检测到恶意字符时对其进行转义处理，如转义单引号、双引号、注释符等，或截断恶意载荷，防止其继续执行。</p>
<ol>
<li>实时检测和响应：</li>
</ol>
<p>SQLPsdem 被设计为能够实时检测 SQL 注入漏洞，并在发现漏洞时及时响应，减少漏洞可能带来的负面影响。</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>SQLPsdem 的评价实验使用了 12 个广泛使用的开源 PHP Web 应用程序。系统生成了超过 52,000 个 SQL 注入测试用例，成功检测出 26 个二阶 SQL 注入漏洞，其中包括 13 个新发现的漏洞。实验结果显示，SQLPsdem 在降低误报和漏报方面非常有效，同时引入的性能开销可以忽略不计。</p>
<h3 id="A-Static-Detection-Method-for-SQL-Injection-Vulnerability-Based-on-Program-Transformation"><a href="#A-Static-Detection-Method-for-SQL-Injection-Vulnerability-Based-on-Program-Transformation" class="headerlink" title="A Static Detection Method for SQL Injection Vulnerability Based on Program Transformation"></a>A Static Detection Method for SQL Injection Vulnerability Based on Program Transformation</h3><blockquote>
<p>Yuan, Ye, et al. “A Static Detection Method for SQL Injection Vulnerability Based on Program Transformation.” Applied Sciences 13.21 (2023): 11763.</p>
</blockquote>
<h4 id="Abstraction-1"><a href="#Abstraction-1" class="headerlink" title="Abstraction"></a>Abstraction</h4><p>该论文提出了一种基于程序转换的静态检测方法，用于检测利用面向对象数据库扩展（OODBE）的 PHP 应用中的 SQL 注入漏洞。文章通过引入程序转换技术，将 OODBE 自动转换为等价的过程式数据库扩展，使现有的静态分析技术可以有效地检测这些漏洞。该方法分为两个阶段：程序转换和漏洞检测。论文还实现了一个名为 OODBE-SCAN 的原型系统，并通过实验验证其有效性，表明该系统在准确性和检测 SQL 注入漏洞的能力方面优于现有的静态分析工具。</p>
<h4 id="Motivation-1"><a href="#Motivation-1" class="headerlink" title="Motivation"></a>Motivation</h4><p>现有的静态分析技术虽然已经较为成熟，但在面对使用面向对象数据库扩展的应用时，往往由于缺乏对这些扩展的准确建模，无法有效地检测 SQL 注入漏洞。这些技术要么仅匹配方法名称，导致大量误报，要么无法识别关键的对象调用，导致漏报。因此，作者提出了一种基于程序转换的新方法，以解决现有方法在检测使用 OODBE 的应用中的 SQL 注入漏洞时的局限性。</p>
<h4 id="设计-2"><a href="#设计-2" class="headerlink" title="设计"></a>设计</h4><h5 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h5><p>论文提出的方法分为两大部分：程序转换和漏洞检测。</p>
<ol>
<li><strong>程序转换</strong>：通过自动识别源点和汇点，将 OODBE 的面向对象代码转换为等价的过程式代码。核心部分包括关键语句识别、调用关系验证和程序转换。关键语句识别通过分析 AST 节点，识别出数据库扩展类的实例化对象和涉及数据库操作的方法。调用关系通过数据流分析进行验证，确保正确的对象方法调用被识别。最后，将面向对象编程风格的代码转换为过程式编程风格的代码。</li>
<li><strong>漏洞检测</strong>：转换后的代码通过控制流图（CFG）构建和污点分析进行检测。CFG 用于描述程序的控制流结构，而污点分析则用于跟踪用户输入如何流经程序，并判断是否可能引发 SQL 注入攻击。</li>
</ol>
<h5 id="实践-1"><a href="#实践-1" class="headerlink" title="实践"></a>实践</h5><ol>
<li><strong>关键语句识别</strong>：使用 AST 解析 PHP 应用代码，遍历节点以识别使用了 MySQLi 或 PDO 数据库扩展的语句。通过正则表达式匹配查找涉及数据库操作的敏感方法（如 <code>query()</code>）的调用，确定潜在的汇点。</li>
<li><strong>调用关系验证</strong>：通过数据流分析追踪对象的状态变化，确定数据库扩展类的实例对象是否传递给了敏感方法，确保这些方法的调用属于真实的汇点。</li>
<li><strong>程序转换</strong>：将识别出的源点和汇点的面向对象代码转换为等价的过程式代码，例如将 <code>$conn = new mysqli()</code> 转换为 <code>$link = mysqli_connect()</code>，从而使静态分析工具能够识别这些语句。</li>
</ol>
<h4 id="实验情况"><a href="#实验情况" class="headerlink" title="实验情况"></a>实验情况</h4><p>作者使用了 8 个代表性的开源 PHP 应用进行实验，这些应用均使用了 MySQLi 或 PDO 数据库扩展。实验结果表明，OODBE-SCAN 在 SQL 注入漏洞检测中表现优异，能够检测到比传统静态分析工具 RIPS 和 Seay 更多的漏洞，且误报率较低。具体实验数据如下：</p>
<ul>
<li>OODBE-SCAN 共检测到 41 个真实漏洞，误报 52 个，精确度为 0.44，召回率为 0.82。</li>
<li>对比工具 RIPS 共检测到 8 个真实漏洞，误报 217 个，精确度为 0.04，召回率为 0.16。</li>
<li>Seay 检测到 24 个真实漏洞，误报 116 个，精确度为 0.17，召回率为 0.48。</li>
</ul>
<h3 id="Automating-SQL-Injection-and-Cross-Site-Scripting-Vulnerability-Remediation-in-Code"><a href="#Automating-SQL-Injection-and-Cross-Site-Scripting-Vulnerability-Remediation-in-Code" class="headerlink" title="Automating SQL Injection and Cross-Site Scripting Vulnerability Remediation in Code"></a>Automating SQL Injection and Cross-Site Scripting Vulnerability Remediation in Code</h3><blockquote>
<p>Sambhus, Kedar, and Yi Liu. “Automating SQL Injection and Cross-Site Scripting Vulnerability Remediation in Code.” Software 3.1 (2024): 28-46.</p>
</blockquote>
<h4 id="Abstraction-2"><a href="#Abstraction-2" class="headerlink" title="Abstraction"></a>Abstraction</h4><p>论文介绍了 CARES（Code Auto-Remediation for Enhanced Security），一个用于自动检测和修复 Java Web 应用程序中 SQL 注入（SQLi）和跨站脚本（XSS）漏洞的工具。CARES 通过 SpotBugs 静态分析工具检测代码中的安全漏洞，并使用拦截过滤器设计模式自动对代码进行重构和修复。该工具的设计具有高度的扩展性，能够适应不同的编程语言和更多类型的安全漏洞。文章通过在开源电子健康记录系统 Tolven 中的实验展示了 CARES 的有效性，实验结果表明该工具能够大幅提高修复效率，减少手动操作的时间和风险。</p>
<h4 id="Motivation-2"><a href="#Motivation-2" class="headerlink" title="Motivation"></a>Motivation</h4><p>随着互联网分布式系统的发展，Web 应用程序面临的安全威胁不断增加，尤其是 SQL 注入和跨站脚本攻击。这些漏洞不仅普遍存在，还容易被恶意利用，带来重大风险。传统的漏洞修复过程通常耗时且昂贵，人工修补可能延迟。为了提高修复效率，开发一个能够自动检测并修复漏洞的工具至关重要。CARES 的开发动机在于减少开发人员在识别和修复漏洞上的工作量，并通过自动化手段提升安全性。</p>
<h4 id="设计-3"><a href="#设计-3" class="headerlink" title="设计"></a>设计</h4><h5 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h5><p>论文中提出的 CARES 工具由三部分组成：代码仓库导入服务、漏洞检查服务和代码修复服务，设计思路围绕这三个核心展开。</p>
<ol>
<li><strong>系统架构</strong>： CARES 基于微服务架构设计，每个服务都是独立的、可扩展的。通过这种模块化的设计，CARES 能够轻松支持更多的漏洞类型和编程语言。各服务通过 HTTP 通信相互交互，提升了系统的灵活性和可维护性。</li>
<li><strong>使用拦截过滤器设计模式</strong>： CARES 通过拦截过滤器模式对 SQLi 和 XSS 漏洞进行修复。这个设计模式允许在应用核心逻辑处理请求之前，对输入数据进行过滤和处理。FilterManager 管理过滤器的执行，每个具体的漏洞（如 SQLi 和 XSS）都有相应的过滤器类来执行消毒操作，确保数据安全。</li>
<li><strong>扩展性和灵活性</strong>： CARES 设计考虑了未来的扩展需求，能支持其他编程语言和更多的安全漏洞类型。微服务架构有助于独立开发和部署每个模块，降低了模块间耦合。</li>
</ol>
<h5 id="实践-2"><a href="#实践-2" class="headerlink" title="实践"></a>实践</h5><ol>
<li><strong>代码仓库导入服务</strong>：使用 JGit 库从 GitHub 等远程仓库克隆代码项目并存储在本地文件系统。</li>
<li><strong>漏洞检查服务</strong>：CARES 利用 SpotBugs 静态分析工具来扫描 Java 应用代码，自动检测 SQLi 和 XSS 漏洞。扫描结果包括漏洞的具体位置，如文件名、类名和行号等，生成 XML 格式报告。</li>
<li><strong>代码修复服务</strong>：根据漏洞检查服务生成的报告，CARES 使用拦截过滤器模式进行代码修复。它将过滤器插入到漏洞代码处，自动生成消毒后的安全代码，最终替换原有的漏洞代码。</li>
</ol>
<h4 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h4><p>论文通过 Tolven 健康记录系统的案例研究，展示了 CARES 的有效性。Tolven 系统是一个开源电子健康记录系统，在该应用中使用 CARES 修复了超过 500 个 SQLi 和 XSS 漏洞。CARES 能够成功扫描、检测并修复这些漏洞，修复过程约耗时 7 分钟。修复后的代码再次通过漏洞扫描工具检查，确认所有相关漏洞已被消除。研究结果表明，CARES 能够显著提高漏洞修复的效率，并减少手动操作的风险和工作量。</p>
<h2 id="漏洞关键片段提取"><a href="#漏洞关键片段提取" class="headerlink" title="漏洞关键片段提取"></a>漏洞关键片段提取</h2><h3 id="示例-1：SQL-注入漏洞关键语句提取"><a href="#示例-1：SQL-注入漏洞关键语句提取" class="headerlink" title="示例 1：SQL 注入漏洞关键语句提取"></a>示例 1：SQL 注入漏洞关键语句提取</h3><p>基于污点分析技术，使用 codeql 对污点进行跟踪，污点传播路径即是关键代码</p>
<p>分析结果如下</p>
<p>预览图</p>
<p><img src="/static/S6vKb1aDuopQioxH5vncBMWjnfd.png"></p>

    </article>
    <!-- license -->
        <div class="license-wrapper">
            <p>Author：<a href="http://example.com">John Doe</a>
            <p>Link：<a href="http://example.com/2024/10/28/%E6%B1%87%E6%80%BB/">http://example.com/2024/10/28/%E6%B1%87%E6%80%BB/</a>
            <p>Publish date：<a href="http://example.com/2024/10/28/%E6%B1%87%E6%80%BB/">October 28th 2024, 5:48:21 pm</a>
            <p>Update date：<a href="http://example.com/2024/10/28/%E6%B1%87%E6%80%BB/">October 28th 2024, 5:48:21 pm</a>
            <p>License：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
                <div class="nextSlogan">Next Post</div>
                <a href="/2024/10/29/hello-world/" title="Hello World">
                    <div class="nextTitle">Hello World</div>
                </a>
        </li>
        <li class="previous">
        </li>
    </ul>
    <!-- comment -->
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->

            
            
            
            <!-- utteranc评论 -->

            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->

            
            
            
        </div>
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    <!-- Mathjax -->
</main>

                <!-- profile -->
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
        <div class="social">
                            <a href="mailto:12345@qq.com" class="iconfont-archer email" title="email" ></a>
                <a href="//github.com/fi3ework" class="iconfont-archer github" target="_blank" title="github"></a>
                <span class="iconfont-archer wechat" title="wechat">
                    <img class="profile-qr" src="/assets/example_qr.png" />
                </span>

        </div>
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    <!-- 不蒜子  -->
        <div class="busuanzi-container">
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
        </div>
</footer>

        </div>
        <!-- toc -->
            <div class="toc-wrapper toc-wrapper-loding" style=    top:50vh;
>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B1%87%E6%80%BB"><span class="toc-number">1.</span> <span class="toc-text">汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BA%E6%96%87"><span class="toc-number">1.1.</span> <span class="toc-text">论文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SAND-A-Static-Analysis-Approach-for-Detecting-SQL-Antipatterns"><span class="toc-number">1.1.1.</span> <span class="toc-text">SAND: A Static Analysis Approach for Detecting SQL Antipatterns</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Abstraction"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Abstraction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Motivation"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Motivation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-%E6%B3%A8%E5%85%A5%E4%B8%8D%E8%89%AF%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">SQL 注入不良模式的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.1.4.1.</span> <span class="toc-text">基本定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.1.1.4.2.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.1.1.4.3.</span> <span class="toc-text">抽象设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90"><span class="toc-number">1.1.1.4.4.</span> <span class="toc-text">过程间分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%84%E4%BC%B0"><span class="toc-number">1.1.1.6.</span> <span class="toc-text">评估</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87"><span class="toc-number">1.1.1.6.1.</span> <span class="toc-text">评估指标</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B7%E6%9C%AC"><span class="toc-number">1.1.1.6.2.</span> <span class="toc-text">样本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">1.1.1.6.3.</span> <span class="toc-text">结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLPsdem-A-Proxy-Based-Mechanism-Towards-Detecting-Locating-and-Preventing-Second-Order-SQL-Injections"><span class="toc-number">1.1.2.</span> <span class="toc-text">SQLPsdem: A Proxy-Based Mechanism Towards  Detecting, Locating and Preventing  Second-Order SQL Injections</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A0%94%E7%A9%B6%E5%8A%A8%E6%9C%BA"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">研究动机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%A1%E7%8C%AE"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">贡献</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.2.3.1.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.1.2.3.2.</span> <span class="toc-text">实践</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">实验</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Static-Detection-Method-for-SQL-Injection-Vulnerability-Based-on-Program-Transformation"><span class="toc-number">1.1.3.</span> <span class="toc-text">A Static Detection Method for SQL Injection Vulnerability Based on Program Transformation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Abstraction-1"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">Abstraction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Motivation-1"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">Motivation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1-2"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF-1"><span class="toc-number">1.1.3.3.1.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E8%B7%B5-1"><span class="toc-number">1.1.3.3.2.</span> <span class="toc-text">实践</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%83%85%E5%86%B5"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">实验情况</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Automating-SQL-Injection-and-Cross-Site-Scripting-Vulnerability-Remediation-in-Code"><span class="toc-number">1.1.4.</span> <span class="toc-text">Automating SQL Injection and Cross-Site Scripting Vulnerability Remediation in Code</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Abstraction-2"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">Abstraction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Motivation-2"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">Motivation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1-3"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF-2"><span class="toc-number">1.1.4.3.1.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E8%B7%B5-2"><span class="toc-number">1.1.4.3.2.</span> <span class="toc-text">实践</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">实验结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%85%B3%E9%94%AE%E7%89%87%E6%AE%B5%E6%8F%90%E5%8F%96"><span class="toc-number">1.2.</span> <span class="toc-text">漏洞关键片段提取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-1%EF%BC%9ASQL-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%85%B3%E9%94%AE%E8%AF%AD%E5%8F%A5%E6%8F%90%E5%8F%96"><span class="toc-number">1.2.1.</span> <span class="toc-text">示例 1：SQL 注入漏洞关键语句提取</span></a></li></ol></li></ol></li></ol>
            </div>
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
        
        
    <div class="total-and-search">
        <div class="total-archive">
        Total : 2
        </div>
        <!-- search  -->
    </div>
    <div class="post-archive">
            <div class="archive-year"> 2024 </div>
            <ul class="year-list">
        <li class="archive-post-item">
            <span class="archive-post-date">10/29</span>
            <a class="archive-post-title" href="/2024/10/29/hello-world/">Hello World</a>
        </li>
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span>
            <a class="archive-post-title" href="/2024/10/28/%E6%B1%87%E6%80%BB/">[Untitled Post]</a>
        </li>
            </ul>
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "http://example.com",
        root: siteMetaRoot,
        author: "John Doe"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->

        <!-- main func -->
        <script src="/scripts/main.js"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.js" onload="window.Fancybox.bind('[data-fancybox]')" defer></script>
        <!-- algolia -->
        <!-- busuanzi -->
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        <!-- async load share.js -->
            <script src="/scripts/share.js" async></script>
        <!-- mermaid -->
    </body>
</html>
